<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>å–µå‘œæ—¥è®° ğŸ±</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{--blue:#007aff;--bg:#f5f5f7;--card:#fff;--text:#1d1d1f;--sub:#86868b;--radius:12px;font-family:-apple-system,BlinkMacSystemFont,"SF Pro",Helvetica,Arial,sans-serif}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);display:flex;justify-content:center;padding:30px 20px}
#app{max-width:600px;width:100%}
header{text-align:center;margin-bottom:30px}h1{font-size:28px;font-weight:600;margin-bottom:6px}header p{color:var(--sub);font-size:15px}
.cal{background:var(--card);border-radius:var(--radius);box-shadow:0 2px 8px rgba(0,0,0,.05);padding:20px;margin-bottom:24px}
.cal header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
.cal h3{font-size:20px;font-weight:600}.cal button{background:none;border:none;font-size:22px;cursor:pointer;color:var(--blue)}
.weekdays{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:8px;font-size:13px;color:var(--sub);text-align:center;font-weight:600}
.days{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;text-align:center}
.days .day{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;border-radius:50%;font-size:15px;cursor:pointer;transition:.2s}
.days .day:hover{background:#e5e5ea}.days .day.other{opacity:.3}.days .day.today{background:var(--blue);color:#fff}.days .day.has{background:#e3f2fd;color:var(--blue);font-weight:600}
.diaryPage{background:var(--card);border-radius:var(--radius);box-shadow:0 2px 8px rgba(0,0,0,.05);padding:30px;display:none}
.diaryPage h2{margin-bottom:10px;font-size:22px}.diaryPage .content{font-size:16px;white-space:pre-wrap}
.actions{margin-top:15px}.actions button{border:none;padding:10px 20px;border-radius:var(--radius);font-size:15px;cursor:pointer;background:#e5e5ea;color:var(--text)}
</style>
</head>
<body>
<div id="app">
    <header>
        <h1>å–µå‘œæ—¥è®° ğŸ±</h1>
        <p>è®°å½•å’ŒçŒ«å’ªçš„æ¯ä¸€å¤©</p>
    </header>
    <div id="calendar" class="cal"></div>
    <div id="diaryPage" class="diaryPage">
        <h2 id="diaryDate"></h2>
        <div id="diaryContent" class="content"></div>
        <div class="actions"><button onclick="backToCalendar()">è¿”å›</button></div>
    </div>
</div>
<script>
const fmt=d=>{
  const y=d.getFullYear(),m=String(d.getMonth()+1).padStart(2,'0'),dd=String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${dd}`;
};
const monthNames='ä¸€æœˆ äºŒæœˆ ä¸‰æœˆ å››æœˆ äº”æœˆ å…­æœˆ ä¸ƒæœˆ å…«æœˆ ä¹æœˆ åæœˆ åä¸€æœˆ åäºŒæœˆ'.split(' ');
const weekdayNames='æ—¥ ä¸€ äºŒ ä¸‰ å›› äº” å…­'.split(' ');
let diaries={};
let current={year:new Date().getFullYear(),month:new Date().getMonth()};
let selectedDay='';

/* è¯»å–æ—¥è®°æ•°æ® */
fetch('miaowu.json')
  .then(r=>r.json())
  .then(data=>{diaries=data;renderCalendar();})
  .catch(()=>{alert('miaowu.json åŠ è½½å¤±è´¥ï¼Œè¯·ç¡®ä¿æ–‡ä»¶åœ¨åŒä¸€ç›®å½•');});

function renderCalendar(){
    const {year,month}=current;
    const first=new Date(year,month,1);
    const start=new Date(first);
    start.setDate(start.getDate()-first.getDay());
    document.getElementById('calendar').innerHTML=`
        <header>
            <button onclick="prevMonth()">â€¹</button>
            <h3>${year}å¹´ ${monthNames[month]}</h3>
            <button onclick="nextMonth()">â€º</button>
        </header>
        <div class="weekdays">${weekdayNames.map(w=>`<div>å‘¨${w}</div>`).join('')}</div>
        <div class="days">${(()=>{
            let html='';
            for(let i=0;i<42;i++){
                const d=new Date(start);
                d.setDate(start.getDate()+i);
                const cls=['day'];
                if(d.getMonth()!==month)cls.push('other');
                if(fmt(d)===fmt(new Date()))cls.push('today');
                if(diaries[fmt(d)])cls.push('has');
                html+=`<div class="${cls.join(' ')}" onclick="openDiary('${fmt(d)}')">${d.getDate()}</div>`;
            }
            return html;
        })()}</div>`;
}
function openDiary(day){
    selectedDay=day;
    document.getElementById('calendar').style.display='none';
    document.getElementById('diaryPage').style.display='block';
    document.getElementById('diaryDate').textContent=`${day.slice(0,4)}å¹´${day.slice(5,7)}æœˆ${day.slice(8,10)}æ—¥ï¼ˆå‘¨${weekdayNames[new Date(day).getDay()]})`;
    document.getElementById('diaryContent').textContent=diaries[day]||'æ²¡æœ‰å†…å®¹';
}
function backToCalendar(){
    document.getElementById('calendar').style.display='block';
    document.getElementById('diaryPage').style.display='none';
}
function prevMonth(){current.month--;if(current.month<0){current.month=11;current.year--;}renderCalendar();}
function nextMonth(){current.month++;if(current.month>11){current.month=0;current.year++;}renderCalendar();}
renderCalendar();
</script>
</body>
</html>
